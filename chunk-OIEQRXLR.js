import{a as J}from"./chunk-MGQZOIFY.js";import{a as $}from"./chunk-IB4BDQBE.js";import{a as q}from"./chunk-D23DP74C.js";import"./chunk-BSM3DYXS.js";import{a as w,b as a,c as E,d as F,g as y,h as j,i as I,j as N,k as U,l as P,m as V,o as D,q as k}from"./chunk-2K3ZRB22.js";import{f as H,g as C}from"./chunk-H4ACMJDA.js";import"./chunk-FKPM6TIP.js";import{$a as n,Da as h,Ia as v,Oa as c,Qa as r,Ra as t,Sa as p,Ta as g,Ua as u,Va as d,Wa as A,Y as f,Z as _,ab as x,bb as T,ua as m,za as b}from"./chunk-GUCOMCN7.js";import"./chunk-2NFLSA4Y.js";function Q(o,i){if(o&1){let e=g();r(0,"div")(1,"span",18),u("click",function(){f(e);let l=d();return _(l.editUser())}),n(2,"edit"),t()()}}function W(o,i){if(o&1){let e=g();r(0,"div")(1,"span",19),u("click",function(){f(e);let l=d();return _(l.cancelUser())}),n(2," cancel "),t()()}}function X(o,i){o&1&&(r(0,"div")(1,"button",20),n(2,"save"),t()())}function Y(o,i){if(o&1){let e=g();r(0,"form",21),u("ngSubmit",function(){f(e);let l=d();return _(l.savePasswordUser())}),r(1,"div")(2,"label",22),n(3,"Password"),t(),p(4,"input",23),t(),r(5,"div")(6,"label",24),n(7,"Repeat Password"),t(),p(8,"input",25),t()()}if(o&2){let e=d();c("formGroup",e.userPasswordForm)}}function Z(o,i){if(o&1){let e=g();r(0,"div")(1,"button",18),u("click",function(){f(e);let l=d();return _(l.editPasswordUser())}),n(2," edit "),t()()}}function ee(o,i){if(o&1){let e=g();r(0,"div")(1,"button",19),u("click",function(){f(e);let l=d();return _(l.cancelPasswordUser())}),n(2," cancel "),t()()}}function te(o,i){if(o&1){let e=g();r(0,"div")(1,"button",26),u("click",function(){f(e);let l=d();return _(l.savePasswordUser())}),n(2," save "),t()()}}var G=class o{constructor(i,e){this.fb=i;this._userService=e;let s=localStorage.getItem("currentUser");this.loadForm(),s?(this.user=JSON.parse(s),this._userService.getById(this.user.id).subscribe({next:l=>{this.user=l,this.cancelUser()},error:l=>{alert("error get data user")}})):alert("user not session")}userForm;userPasswordForm;activateEditUser;activateEditUserPassword;user;loadForm(){this.userForm=this.fb.group({email:["",[a.required,a.email]],firstName:["",[a.required]],lastName:["",[a.required]],role:["",[a.required]],salary:[0,[a.required,a.min(0)]]}),this.userPasswordForm=this.fb.group({password:["",[a.required]],repeatPassword:["",[a.required]]})}editUser(){this.activateEditUser=!0,this.userForm.enable()}saveUser(){if(this.userForm.valid){let i=this.userForm.value;this._userService.updateUser(this.user.id,i.email,i.role,i.firstName,i.lastName,i.salary).subscribe({next:e=>{this.user=e,alert("Data user Update Succesfull"),localStorage.setItem("currentUser",JSON.stringify(e)),this.cancelUser()},error:()=>{alert("erro al actualizar"),this.cancelUser()}})}}cancelUser(){this.activateEditUser=!1,this.userForm=this.fb.group({email:[this.user.email,[a.required,a.email]],firstName:[this.user.firstName,[a.required]],lastName:[this.user.lastName,[a.required]],role:[this.user.role,[a.required]],salary:[this.user.salary,[a.required,a.min(0)]]}),this.userForm.disable()}editPasswordUser(){this.activateEditUserPassword=!0}savePasswordUser(){let i=this.userPasswordForm.value;this.userPasswordForm.valid&&i.password===i.repeatPassword&&this._userService.updateUserPassword(this.user.id,i.password).subscribe({next:e=>{alert("change password succesfull"),localStorage.setItem("currentUser",JSON.stringify(e)),this.cancelPasswordUser()},error:e=>{alert("erro to change password"),this.cancelPasswordUser()}})}cancelPasswordUser(){this.userPasswordForm=this.fb.group({password:["",[a.required]],repeatPassword:["",[a.required]]}),this.activateEditUserPassword=!1}static \u0275fac=function(e){return new(e||o)(b(D),b($))};static \u0275cmp=h({type:o,selectors:[["app-user-settings"]],decls:42,vars:8,consts:[[1,"container-form"],[1,"card","p-4"],[1,"row","row-cols-2","g-3",3,"ngSubmit","formGroup"],["for","firstName",1,"form-label"],["type","text","formControlName","firstName",1,"form-control"],["for","lastName",1,"form-label"],["type","text","formControlName","lastName",1,"form-control"],["for","email",1,"form-label"],["type","email","formControlName","email","placeholder","ejemplo@correo.com",1,"form-control"],["for","salary",1,"form-label"],["type","number","formControlName","salary",1,"form-control"],["for","role",1,"form-label"],["formControlName","role",1,"form-control"],["value","member"],["value","representative"],[4,"ngIf"],["class","row row-cols-1 g-3",3,"formGroup","ngSubmit",4,"ngIf"],[1,"row","row-cols-2","g-3","mt-2"],[1,"btn","btn-primary","w-100",3,"click"],[1,"btn","btn-danger","w-100",3,"click"],["type","submit",1,"btn","btn-success","w-100"],[1,"row","row-cols-1","g-3",3,"ngSubmit","formGroup"],["for","password",1,"form-label"],["type","password","formControlName","password","placeholder","********",1,"form-control"],["for","repeat-password",1,"form-label"],["type","password","formControlName","repeatPassword","placeholder","********",1,"form-control"],[1,"btn","btn-success","w-100",3,"click"]],template:function(e,s){e&1&&(r(0,"div",0)(1,"div",1)(2,"legend"),n(3,"User Data"),t(),r(4,"form",2),u("ngSubmit",function(){return s.saveUser()}),r(5,"div")(6,"label",3),n(7,"First Name"),t(),p(8,"input",4),t(),r(9,"div")(10,"label",5),n(11,"Last Name"),t(),p(12,"input",6),t(),r(13,"div")(14,"label",7),n(15,"Email"),t(),p(16,"input",8),t(),r(17,"div")(18,"label",9),n(19,"Salary"),t(),p(20,"input",10),t(),r(21,"div")(22,"label",11),n(23,"Role"),t(),r(24,"select",12)(25,"option"),n(26,"--selection role---"),t(),r(27,"option",13),n(28,"Member"),t(),r(29,"option",14),n(30,"Representative"),t()()(),v(31,Q,3,0,"div",15)(32,W,3,0,"div",15)(33,X,3,0,"div",15),t()(),r(34,"div",1)(35,"legend"),n(36,"Change password"),t(),v(37,Y,9,1,"form",16),r(38,"div",17),v(39,Z,3,0,"div",15)(40,ee,3,0,"div",15)(41,te,3,0,"div",15),t()()()),e&2&&(m(4),c("formGroup",s.userForm),m(27),c("ngIf",!s.activateEditUser),m(),c("ngIf",s.activateEditUser),m(),c("ngIf",s.activateEditUser),m(4),c("ngIf",s.activateEditUserPassword),m(2),c("ngIf",!s.activateEditUserPassword),m(),c("ngIf",s.activateEditUserPassword),m(),c("ngIf",s.activateEditUserPassword))},dependencies:[k,y,P,V,w,j,U,E,F,I,N,C],encapsulation:2})};function re(o,i){if(o&1){let e=g();r(0,"tr")(1,"td"),n(2),t(),r(3,"td"),n(4),t(),r(5,"td"),n(6),t(),r(7,"td")(8,"div",11)(9,"span",12),u("click",function(){let l=f(e).$implicit,S=d();return _(S.editTable(l))}),n(10,"Edit"),t(),r(11,"span",13),u("click",function(){let l=f(e).$implicit,S=d();return _(S.deleteHouse(l.id))}),n(12,"Delete"),t()()()()}if(o&2){let e=i.$implicit;m(2),x(e.name),m(2),x(e.description),m(2),x(e.currency)}}function ne(o,i){if(o&1&&(r(0,"form",14)(1,"div")(2,"label",15),n(3,"name"),t(),p(4,"input",16),t(),r(5,"div")(6,"label",17),n(7,"description"),t(),p(8,"textarea",18),t(),r(9,"div")(10,"label",19),n(11,"currency"),t(),r(12,"select",20)(13,"option"),n(14,"--selection currency---"),t(),r(15,"option",21),n(16,"PEN"),t(),r(17,"option",22),n(18,"USD"),t()()()()),o&2){let e=d();c("formGroup",e.houseForm)}}function oe(o,i){if(o&1){let e=g();r(0,"span",23),u("click",function(){f(e);let l=d();return _(l.initform())}),n(1,"Create"),t()}}function se(o,i){if(o&1){let e=g();r(0,"span",24),u("click",function(){f(e);let l=d();return _(l.initform())}),n(1,"cancel"),t()}}function ae(o,i){if(o&1){let e=g();r(0,"span",23),u("click",function(){f(e);let l=d();return _(l.saveHouse())}),n(1,"save"),t()}}var M=class o{constructor(i,e){this._houseService=i;this.fb=e;let s=localStorage.getItem("currentUser"),l=JSON.parse(s||"");this.user_id=l?l.id:"",this.houseForm=this.fb.group({id:[],name:["",[a.required]],description:["",[a.required,a.maxLength(50)]],currency:["",[a.required]]}),this.loadData()}user_id;housesList;activateForm;activateFormEdit;houseForm;loadData(){this._houseService.getAllByRepre(this.user_id).subscribe({next:i=>{this.housesList=i},error:i=>{alert("Failed data list house")}})}initform(){this.activateForm=!this.activateForm,this.houseForm=this.fb.group({id:[],name:["",[a.required]],description:["",[a.required,a.maxLength(50)]],currency:["",[a.required]]}),this.activateFormEdit=!1}editTable(i){this.houseForm=this.fb.group({id:[i.id],name:[i.name,[a.required]],description:[i.description,[a.required,a.maxLength(50)]],currency:[i.currency,[a.required]]}),this.activateForm=!0,this.activateFormEdit=!0}saveHouse(){let i=this.houseForm.value;this.houseForm.valid?i.id?this._houseService.updateById(i.id,i.name,i.description,i.currency).subscribe({next:e=>{this.loadData(),this.initform()},error:e=>{alert("error update house "+i.name)}}):this._houseService.createById(this.user_id,i.name,i.description,i.currency).subscribe({next:e=>{this.initform(),this.loadData()},error:e=>{alert("error create house")}}):alert("data not valid")}deleteHouse(i){this._houseService.deleteById(i).subscribe({next:e=>{this.loadData()},error:e=>{alert("error delete house ")}})}static \u0275fac=function(e){return new(e||o)(b(q),b(D))};static \u0275cmp=h({type:o,selectors:[["app-house-settings"]],decls:25,vars:6,consts:[[1,"container-form"],[1,"card","p-4","w-100"],[1,"table-responsive"],[1,"table","table-bordered","table-striped"],[1,"table-dark"],[4,"ngFor","ngForOf"],[1,"card","p-4"],["class","row row-cols-1 g-3",3,"formGroup",4,"ngIf"],["class","btn btn-success w-100 mt-3",3,"click",4,"ngIf"],[1,"d-flex",2,"column-gap","16px"],["class","btn btn-danger w-100 mt-3",3,"click",4,"ngIf"],[1,"d-flex",2,"column-gap","10px"],[1,"btn","btn-primary","w-100",3,"click"],[1,"btn","btn-danger","w-100",3,"click"],[1,"row","row-cols-1","g-3",3,"formGroup"],["for","name",1,"form-label"],["type","text","formControlName","name",1,"form-control"],["for","description",1,"form-label"],["formControlName","description",1,"form-control"],["for","currency",1,"form-label"],["formControlName","currency",1,"form-control"],["value","PEN"],["value","USD"],[1,"btn","btn-success","w-100","mt-3",3,"click"],[1,"btn","btn-danger","w-100","mt-3",3,"click"]],template:function(e,s){e&1&&(r(0,"div",0)(1,"div",1)(2,"legend"),n(3,"List the houses"),t(),r(4,"div",2)(5,"table",3)(6,"thead",4)(7,"tr")(8,"th"),n(9,"Name"),t(),r(10,"th"),n(11,"Description"),t(),r(12,"th"),n(13,"Currency"),t(),p(14,"th"),t()(),r(15,"tbody"),v(16,re,13,3,"tr",5),t()()()(),r(17,"div",6)(18,"legend"),n(19),t(),v(20,ne,19,1,"form",7)(21,oe,2,0,"span",8),r(22,"div",9),v(23,se,2,0,"span",10)(24,ae,2,0,"span",8),t()()()),e&2&&(m(16),c("ngForOf",s.housesList),m(3),T("",s.activateFormEdit?"Edit":"Create"," house"),m(),c("ngIf",s.activateForm),m(),c("ngIf",!s.activateForm),m(2),c("ngIf",s.activateForm),m(),c("ngIf",s.activateForm))},dependencies:[H,C,k,y,P,V,w,U,E,F,I,N],encapsulation:2})};function le(o,i){if(o&1){let e=g();r(0,"tr")(1,"td"),n(2),t(),r(3,"td"),n(4),t(),r(5,"td"),n(6),t(),r(7,"td"),n(8),t(),r(9,"td")(10,"div",11)(11,"span",12),u("click",function(){let l=f(e).$implicit,S=d();return _(S.editTable(l))}),n(12,"Edit"),t(),r(13,"span",13),u("click",function(){let l=f(e).$implicit,S=d();return _(S.deletePeriod(l.id))}),n(14,"Delete"),t()()()()}if(o&2){let e=i.$implicit;m(2),x(e.name),m(2),x(e.dateInit),m(2),x(e.dateDue),m(2),x(e.house_name)}}function me(o,i){if(o&1&&(r(0,"option",26),n(1),t()),o&2){let e=i.$implicit;A("value",e.id),m(),T(" ",e.name," ")}}function ce(o,i){if(o&1&&(r(0,"form",14)(1,"div")(2,"label",15),n(3,"name"),t(),p(4,"input",16),t(),r(5,"div",17)(6,"div",18)(7,"label",19),n(8,"Date Init"),t(),p(9,"input",20),t(),r(10,"div",18)(11,"label",21),n(12,"Date Due"),t(),p(13,"input",22),t()(),r(14,"div")(15,"label",23),n(16,"House"),t(),r(17,"select",24)(18,"option"),n(19,"--selection House---"),t(),v(20,me,2,2,"option",25),t()()()),o&2){let e=d();c("formGroup",e.periodForm),m(20),c("ngForOf",e.houseList)}}function de(o,i){if(o&1){let e=g();r(0,"span",27),u("click",function(){f(e);let l=d();return _(l.initform())}),n(1,"Create"),t()}}function pe(o,i){if(o&1){let e=g();r(0,"span",28),u("click",function(){f(e);let l=d();return _(l.initform())}),n(1,"cancel"),t()}}function ue(o,i){if(o&1){let e=g();r(0,"span",27),u("click",function(){f(e);let l=d();return _(l.savePeriod())}),n(1,"save"),t()}}var O=class o{constructor(i,e,s){this._periodService=i;this.fb=e;this._houseService=s;let l=localStorage.getItem("currentUser"),S=JSON.parse(l||"");this.user_id=S?S.id:"",this.periodForm=this.fb.group({id:[],name:["",[a.required]],dateInit:["",[a.required]],dateDue:["",[a.required]],house_id:["",[a.required]]}),this.loadData()}user_id;periodsList;activateForm;activateFormEdit;periodForm;houseList;loadData(){this._periodService.getAllByRepre(this.user_id).subscribe({next:i=>{this.periodsList=i,this._houseService.getAllByRepre(this.user_id).subscribe({next:e=>{this.houseList=e,this.periodsList=this.periodsList.map(s=>{let l=this.houseList.find(S=>S.id==s.house_id)||{};return{id:s.id,name:s.name,dateInit:s.dateInit,dateDue:s.dateDue,owner_id:s.owner_id,house_id:s.house_id,house_name:l.name??"undefined"}})},error:e=>{alert("Failed data list House")}})},error:i=>{alert("Failed data list period")}})}initform(){this.activateForm=!this.activateForm,this.periodForm=this.fb.group({id:[],name:["",[a.required]],dateInit:["",[a.required]],dateDue:["",[a.required]],house_id:["",[a.required]]}),this.activateFormEdit=!1}editTable(i){this.periodForm=this.fb.group({id:[i.id],name:[i.name,[a.required]],dateInit:[i.dateInit,[a.required]],dateDue:[i.dateDue,[a.required]],house_id:[i.house_id,[a.required]]}),this.activateForm=!0,this.activateFormEdit=!0}savePeriod(){let i=this.periodForm.value;this.periodForm.valid?i.id?this._periodService.updateById(i.id,i.name,i.dateInit,i.dateDue,i.house_id).subscribe({next:e=>{this.loadData(),this.initform()},error:e=>{alert("error update period "+i.name)}}):this._periodService.createById(this.user_id,i.name,i.dateInit,i.dateDue,i.house_id).subscribe({next:e=>{this.loadData(),this.initform()},error:e=>{alert("error create period")}}):alert("data not valid")}deletePeriod(i){this._periodService.deleteById(i).subscribe({next:e=>{this.loadData()},error:e=>{alert("error delete period ")}})}static \u0275fac=function(e){return new(e||o)(b(J),b(D),b(q))};static \u0275cmp=h({type:o,selectors:[["app-period-settings"]],decls:27,vars:6,consts:[[1,"container-form"],[1,"card","p-4","w-100"],[1,"table-responsive"],[1,"table","table-bordered","table-striped"],[1,"table-dark"],[4,"ngFor","ngForOf"],[1,"card","p-4"],["class","row row-cols-1 g-3",3,"formGroup",4,"ngIf"],["class","btn btn-success w-100 mt-3",3,"click",4,"ngIf"],[1,"d-flex",2,"column-gap","16px"],["class","btn btn-danger w-100 mt-3",3,"click",4,"ngIf"],[1,"d-flex",2,"column-gap","10px"],[1,"btn","btn-primary","w-100",3,"click"],[1,"btn","btn-danger","w-100",3,"click"],[1,"row","row-cols-1","g-3",3,"formGroup"],["for","name",1,"form-label"],["type","text","formControlName","name",1,"form-control"],[1,"row"],[1,"col-6"],["for","dateInit",1,"form-label"],["type","date","formControlName","dateInit",1,"form-control"],["for","dateDue",1,"form-label"],["type","date","formControlName","dateDue",1,"form-control"],["for","house_id",1,"form-label"],["formControlName","house_id",1,"form-control"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],[1,"btn","btn-success","w-100","mt-3",3,"click"],[1,"btn","btn-danger","w-100","mt-3",3,"click"]],template:function(e,s){e&1&&(r(0,"div",0)(1,"div",1)(2,"legend"),n(3,"List the periods"),t(),r(4,"div",2)(5,"table",3)(6,"thead",4)(7,"tr")(8,"th"),n(9,"Name"),t(),r(10,"th"),n(11,"Date Init"),t(),r(12,"th"),n(13,"Date Due"),t(),r(14,"th"),n(15,"House"),t(),p(16,"th"),t()(),r(17,"tbody"),v(18,le,15,4,"tr",5),t()()()(),r(19,"div",6)(20,"legend"),n(21),t(),v(22,ce,21,2,"form",7)(23,de,2,0,"span",8),r(24,"div",9),v(25,pe,2,0,"span",10)(26,ue,2,0,"span",8),t()()()),e&2&&(m(18),c("ngForOf",s.periodsList),m(3),T("",s.activateFormEdit?"Edit":"Create"," period"),m(),c("ngIf",s.activateForm),m(),c("ngIf",!s.activateForm),m(2),c("ngIf",s.activateForm),m(),c("ngIf",s.activateForm))},dependencies:[H,C,k,y,P,V,w,U,E,F,I,N],encapsulation:2})};var R=class o{static \u0275fac=function(e){return new(e||o)};static \u0275cmp=h({type:o,selectors:[["app-preferences-settings"]],decls:2,vars:0,template:function(e,s){e&1&&(r(0,"p"),n(1,"preferences-settings works!"),t())},encapsulation:2})};var K=class o{static \u0275fac=function(e){return new(e||o)};static \u0275cmp=h({type:o,selectors:[["app-repre-settings"]],decls:17,vars:0,consts:[[1,"container","p-0"],["id","user-settings",1,"mb-5"],[1,"text-light","border-bottom","border-light"],["id","house-settings",1,"mb-5"],["id","period-settings",1,"mb-5"],["id","preferences-settings",1,"mb-5"]],template:function(e,s){e&1&&(r(0,"div",0)(1,"section",1)(2,"h1",2),n(3,"User Settings"),t(),p(4,"app-user-settings"),t(),r(5,"section",3)(6,"h1",2),n(7,"Houses Settings"),t(),p(8,"app-house-settings"),t(),r(9,"section",4)(10,"h1",2),n(11,"Period Settings"),t(),p(12,"app-period-settings"),t(),r(13,"section",5)(14,"h1",2),n(15,"Preferences Settings"),t(),p(16,"app-preferences-settings"),t()())},dependencies:[G,M,O,R],encapsulation:2})};export{K as RepreSettingsComponent};
