"use strict";(self.webpackChunkspliteasy_frontend=self.webpackChunkspliteasy_frontend||[]).push([[12],{4012:(B,b,p)=>{p.r(b),p.d(b,{MemberModule:()=>X});var u=p(2881),F=p(5207),t=p(1360),h=p(7643),f=p(5779),_=p(7062);const I=(s,r)=>({"bg-success":s,"bg-warning":r});function k(s,r){1&s&&(t.j41(0,"tr")(1,"th"),t.EFF(2,"Factura"),t.k0s(),t.j41(3,"th"),t.EFF(4,"Descripci\xf3n"),t.k0s(),t.j41(5,"th"),t.EFF(6,"Monto"),t.k0s(),t.j41(7,"th"),t.EFF(8,"Estrategia"),t.k0s(),t.j41(9,"th"),t.EFF(10,"Fecha l\xedmite"),t.k0s(),t.j41(11,"th"),t.EFF(12,"Estado"),t.k0s(),t.j41(13,"th"),t.EFF(14,"Acciones"),t.k0s()())}function C(s,r){if(1&s){const e=t.RV6();t.j41(0,"button",8),t.bIt("click",function(){t.eBV(e);const o=t.XpG().$implicit,d=t.XpG(2);return t.Njj(d.pagar(o))}),t.EFF(1," Pagar "),t.k0s()}}function R(s,r){1&s&&t.nrm(0,"i",9)}function M(s,r){if(1&s&&(t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.nI1(7,"currency"),t.k0s(),t.j41(8,"td"),t.EFF(9),t.k0s(),t.j41(10,"td"),t.EFF(11),t.nI1(12,"date"),t.k0s(),t.j41(13,"td")(14,"span",5),t.EFF(15),t.k0s()(),t.j41(16,"td"),t.DNE(17,C,2,0,"button",6)(18,R,1,0,"i",7),t.k0s()()),2&s){const e=r.$implicit;t.R7$(2),t.JRh(e.billDescripcion),t.R7$(2),t.JRh(e.descripcion),t.R7$(2),t.JRh(t.bMT(7,9,e.monto)),t.R7$(3),t.JRh(e.strategy),t.R7$(2),t.JRh(t.i5U(12,11,e.fechaLimite,"longDate")),t.R7$(3),t.Y8G("ngClass",t.l_i(14,I,"PAGADO"===e.status,"PENDIENTE"===e.status)),t.R7$(),t.SpI(" ",e.status," "),t.R7$(2),t.Y8G("ngIf","PENDIENTE"===e.status),t.R7$(),t.Y8G("ngIf","PAGADO"===e.status)}}function j(s,r){if(1&s&&(t.j41(0,"p-table",2),t.DNE(1,k,15,0,"ng-template",3)(2,M,19,17,"ng-template",4),t.k0s()),2&s){const e=t.XpG();t.Y8G("value",e.contributions)("paginator",!0)("rows",5)("responsiveLayout","scroll")("showCurrentPageReport",!0)}}let v=(()=>{class s{http;userId;contributions=[];isLoading=!0;constructor(e){this.http=e}ngOnInit(){const e=JSON.parse(localStorage.getItem("currentUser"));this.userId=+e.id,this.fetchContributions()}fetchContributions(){this.isLoading=!0,this.http.get(`http://localhost:3000/member_contributions?member_id=${this.userId}`).subscribe(e=>{e.map(o=>o.contribution_id),this.http.get("http://localhost:3000/contributions").subscribe(o=>{this.http.get("http://localhost:3000/bills").subscribe(d=>{this.contributions=e.map(i=>{const c=o.find(l=>l.id==i.contribution_id),a=d.find(l=>l.id==c?.bill_id);return{...i,descripcion:c?.descripcion,strategy:c?.strategy,fechaLimite:c?.fecha_limite,billDescripcion:a?.descripcion,fechaFactura:a?.fecha,montoFactura:a?.monto}}),this.isLoading=!1})})})}pagar(e){const n={...e,status:"PAGADO",pagado_en:(new Date).toISOString()};this.http.patch(`http://localhost:3000/member_contributions/${e.id}`,n).subscribe(()=>{this.fetchContributions()})}static \u0275fac=function(n){return new(n||s)(t.rXU(h.Qq))};static \u0275cmp=t.VBU({type:s,selectors:[["app-memb-contributions"]],standalone:!1,decls:2,vars:1,consts:[[1,"p-4","max-w-screen-lg","mx-auto"],["currentPageReportTemplate","Mostrando {first} a {last} de {totalRecords} contribuciones",3,"value","paginator","rows","responsiveLayout","showCurrentPageReport",4,"ngIf"],["currentPageReportTemplate","Mostrando {first} a {last} de {totalRecords} contribuciones",3,"value","paginator","rows","responsiveLayout","showCurrentPageReport"],["pTemplate","header"],["pTemplate","body"],[1,"badge",3,"ngClass"],["class","btn btn-sm btn-primary",3,"click",4,"ngIf"],["class","pi pi-check-circle text-success",4,"ngIf"],[1,"btn","btn-sm","btn-primary",3,"click"],[1,"pi","pi-check-circle","text-success"]],template:function(n,o){1&n&&(t.j41(0,"div",0),t.DNE(1,j,3,5,"p-table",1),t.k0s()),2&n&&(t.R7$(),t.Y8G("ngIf",!o.isLoading))},dependencies:[u.YU,u.bT,f.Ei,_.XI,u.oe,u.vh],encapsulation:2})}return s})();var g=p(491);const y=s=>({"font-bold text-primary":s});function $(s,r){if(1&s&&(t.j41(0,"li"),t.EFF(1),t.j41(2,"span",10),t.EFF(3),t.k0s()()),2&s){const e=r.$implicit;t.R7$(),t.Lme(" ",e.name," (",e.email,") - "),t.R7$(),t.Y8G("ngClass",t.eq3(4,y,"REPRESENTANTE"===e.role)),t.R7$(),t.SpI(" ",e.role," ")}}function S(s,r){if(1&s&&(t.j41(0,"div",1)(1,"div",2)(2,"div",3)(3,"p-card",4)(4,"p")(5,"strong"),t.EFF(6,"Nombre:"),t.k0s(),t.EFF(7),t.k0s(),t.j41(8,"p")(9,"strong"),t.EFF(10,"Moneda:"),t.k0s(),t.EFF(11),t.k0s(),t.j41(12,"p")(13,"strong"),t.EFF(14,"Descripci\xf3n:"),t.k0s(),t.EFF(15),t.k0s()()(),t.j41(16,"div",3)(17,"p-card",5)(18,"p")(19,"strong"),t.EFF(20,"Total pendiente:"),t.k0s(),t.EFF(21),t.nI1(22,"currency"),t.k0s(),t.j41(23,"p")(24,"strong"),t.EFF(25,"Total pagado:"),t.k0s(),t.EFF(26),t.nI1(27,"currency"),t.k0s(),t.j41(28,"p")(29,"strong"),t.EFF(30,"Contribuciones activas:"),t.k0s(),t.EFF(31),t.k0s()()(),t.j41(32,"div",6)(33,"p-card",7)(34,"ul",8),t.DNE(35,$,4,6,"li",9),t.k0s()()()()()),2&s){const e=t.XpG();t.R7$(7),t.SpI(" ",e.household.name,""),t.R7$(4),t.SpI(" ",e.household.currency,""),t.R7$(4),t.SpI(" ",e.household.description,""),t.R7$(6),t.SpI(" ",t.i5U(22,7,e.totalPendiente,e.household.currency),""),t.R7$(5),t.SpI(" ",t.i5U(27,10,e.totalPagado,e.household.currency),""),t.R7$(5),t.SpI(" ",e.contributions.length,""),t.R7$(4),t.Y8G("ngForOf",e.members)}}let T=(()=>{class s{http;userId;household=null;members=[];contributions=[];totalPendiente=0;totalPagado=0;constructor(e){this.http=e}ngOnInit(){const e=JSON.parse(localStorage.getItem("currentUser"));this.userId=+e.id,this.http.get(`http://localhost:3000/household_members?user_id=${this.userId}`).subscribe(n=>{const o=n[0]?.household_id;o&&this.http.get(`http://localhost:3000/households?id=${o}`).subscribe(d=>{this.household=d[0];const i=this.household.representante_id;this.http.get(`http://localhost:3000/household_members?household_id=${o}`).subscribe(c=>{const a=c.map(l=>l.user_id);a.includes(i)||a.push(i),this.http.get("http://localhost:3000/users").subscribe(l=>{this.members=l.filter(V=>a.includes(V.id))})}),this.http.get(`http://localhost:3000/member_contributions?member_id=${this.userId}`).subscribe(c=>{this.contributions=c,this.totalPendiente=c.filter(a=>"PENDIENTE"===a.status).reduce((a,l)=>a+(Number(l.monto)||0),0),this.totalPagado=c.filter(a=>"PAGADO"===a.status).reduce((a,l)=>a+(Number(l.monto)||0),0)})})})}static \u0275fac=function(n){return new(n||s)(t.rXU(h.Qq))};static \u0275cmp=t.VBU({type:s,selectors:[["app-memb-home"]],standalone:!1,decls:1,vars:1,consts:[["class","p-4 max-w-screen-lg mx-auto",4,"ngIf"],[1,"p-4","max-w-screen-lg","mx-auto"],[1,"grid","mt-3"],[1,"col-12","md:col-6","p-1"],["header","Mi hogar"],["header","Mi situaci\xf3n financiera"],[1,"col-12","p-1"],["header","Miembros del hogar"],[1,"list-disc","pl-4"],[4,"ngFor","ngForOf"],[3,"ngClass"]],template:function(n,o){1&n&&t.DNE(0,S,36,13,"div",0),2&n&&t.Y8G("ngIf",o.household)},dependencies:[u.YU,u.Sq,u.bT,g.Zp,u.oe],encapsulation:2})}return s})();const D=(s,r)=>({"bg-success":s,"bg-warning":r});function G(s,r){1&s&&(t.j41(0,"tr")(1,"th"),t.EFF(2,"Factura"),t.k0s(),t.j41(3,"th"),t.EFF(4,"Descripci\xf3n"),t.k0s(),t.j41(5,"th"),t.EFF(6,"Estrategia"),t.k0s(),t.j41(7,"th"),t.EFF(8,"Monto"),t.k0s(),t.j41(9,"th"),t.EFF(10,"Fecha l\xedmite"),t.k0s(),t.j41(11,"th"),t.EFF(12,"Estado"),t.k0s(),t.j41(13,"th"),t.EFF(14,"Pagado en"),t.k0s()())}function N(s,r){if(1&s&&(t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td"),t.EFF(4),t.k0s(),t.j41(5,"td"),t.EFF(6),t.k0s(),t.j41(7,"td"),t.EFF(8),t.nI1(9,"currency"),t.k0s(),t.j41(10,"td"),t.EFF(11),t.nI1(12,"date"),t.k0s(),t.j41(13,"td")(14,"span",5),t.EFF(15),t.k0s()(),t.j41(16,"td"),t.EFF(17),t.nI1(18,"date"),t.k0s()()),2&s){const e=r.$implicit;t.R7$(2),t.JRh(e.descripcionFactura),t.R7$(2),t.JRh(e.descripcionContrib),t.R7$(2),t.JRh(e.strategy),t.R7$(2),t.JRh(t.bMT(9,8,e.monto)),t.R7$(3),t.JRh(t.i5U(12,10,e.fechaLimite,"longDate")),t.R7$(3),t.Y8G("ngClass",t.l_i(16,D,"PAGADO"===e.status,"PENDIENTE"===e.status)),t.R7$(),t.SpI(" ",e.status," "),t.R7$(2),t.JRh(e.pagadoEn?t.i5U(18,13,e.pagadoEn,"short"):"-")}}let P=(()=>{class s{http;userId;statusList=[];constructor(e){this.http=e}ngOnInit(){const e=JSON.parse(localStorage.getItem("currentUser"));this.userId=+e.id,this.loadStatus()}loadStatus(){this.http.get(`http://localhost:3000/member_contributions?member_id=${this.userId}`).subscribe(e=>{e.map(o=>o.contribution_id),this.http.get("http://localhost:3000/contributions").subscribe(o=>{this.http.get("http://localhost:3000/bills").subscribe(d=>{this.statusList=e.map(i=>{const c=o.find(l=>l.id===i.contribution_id),a=d.find(l=>l.id===c?.bill_id);return{descripcionFactura:a?.descripcion,montoFactura:a?.monto,fechaFactura:a?.fecha,descripcionContrib:c?.descripcion,strategy:c?.strategy,fechaLimite:c?.fecha_limite,monto:i.monto,status:i.status,pagadoEn:i.pagado_en}})})})})}static \u0275fac=function(n){return new(n||s)(t.rXU(h.Qq))};static \u0275cmp=t.VBU({type:s,selectors:[["app-memb-status"]],standalone:!1,decls:5,vars:4,consts:[[1,"p-4","max-w-screen-lg","mx-auto"],["header","Estado de mis contribuciones"],[3,"value","paginator","rows","responsiveLayout"],["pTemplate","header"],["pTemplate","body"],[1,"badge",3,"ngClass"]],template:function(n,o){1&n&&(t.j41(0,"div",0)(1,"p-card",1)(2,"p-table",2),t.DNE(3,G,15,0,"ng-template",3)(4,N,19,19,"ng-template",4),t.k0s()()()),2&n&&(t.R7$(2),t.Y8G("value",o.statusList)("paginator",!0)("rows",5)("responsiveLayout","scroll"))},dependencies:[u.YU,f.Ei,g.Zp,_.XI,u.oe,u.vh],encapsulation:2})}return s})();var x=p(1141),U=p(5430),m=p(9417),E=p(8150);const J=()=>({label:"Espa\xf1ol",value:"es"}),O=()=>({label:"Ingl\xe9s",value:"en"}),w=(s,r)=>[s,r],L=[{path:"",redirectTo:"home",pathMatch:"full"},{path:"home",component:T},{path:"contributions",component:v},{path:"status",component:P},{path:"settings",component:(()=>{class s{http;userId;settings={language:"es",dark_mode:!1,notifications_enabled:!0};settingsId;constructor(e){this.http=e}ngOnInit(){const e=JSON.parse(localStorage.getItem("currentUser"));this.userId=+e.id,this.http.get(`http://localhost:3000/settings?user_id=${this.userId}`).subscribe(n=>{n.length>0&&(this.settings={...n[0]},this.settingsId=n[0].id)})}save(){this.http.patch(`http://localhost:3000/settings/${this.settingsId}`,this.settings).subscribe(()=>{alert("Preferencias actualizadas correctamente.")})}static \u0275fac=function(n){return new(n||s)(t.rXU(h.Qq))};static \u0275cmp=t.VBU({type:s,selectors:[["app-memb-settings"]],standalone:!1,decls:17,vars:9,consts:[[1,"p-4","max-w-screen-sm","mx-auto"],["header","Configuraci\xf3n de usuario"],[1,"grid","formgrid","p-fluid",3,"ngSubmit"],[1,"field","col-12"],["for","language"],["inputId","language","name","language","placeholder","Selecciona un idioma",3,"ngModelChange","ngModel","options"],[1,"field-checkbox","col-12"],["name","dark_mode","binary","true",3,"ngModelChange","ngModel"],["for","dark_mode"],["name","notifications_enabled","binary","true",3,"ngModelChange","ngModel"],["for","notifications_enabled"],[1,"col-12","mt-3"],["pButton","","type","submit","label","Guardar",1,"p-button-primary","w-full"]],template:function(n,o){1&n&&(t.j41(0,"div",0)(1,"p-card",1)(2,"form",2),t.bIt("ngSubmit",function(){return o.save()}),t.j41(3,"div",3)(4,"label",4),t.EFF(5,"Idioma"),t.k0s(),t.j41(6,"p-dropdown",5),t.mxI("ngModelChange",function(i){return t.DH7(o.settings.language,i)||(o.settings.language=i),i}),t.k0s()(),t.j41(7,"div",6)(8,"p-checkbox",7),t.mxI("ngModelChange",function(i){return t.DH7(o.settings.dark_mode,i)||(o.settings.dark_mode=i),i}),t.k0s(),t.j41(9,"label",8),t.EFF(10,"Modo oscuro"),t.k0s()(),t.j41(11,"div",6)(12,"p-checkbox",9),t.mxI("ngModelChange",function(i){return t.DH7(o.settings.notifications_enabled,i)||(o.settings.notifications_enabled=i),i}),t.k0s(),t.j41(13,"label",10),t.EFF(14,"Recibir notificaciones"),t.k0s()(),t.j41(15,"div",11),t.nrm(16,"button",12),t.k0s()()()()),2&n&&(t.R7$(6),t.R50("ngModel",o.settings.language),t.Y8G("options",t.l_i(6,w,t.lJ4(4,J),t.lJ4(5,O))),t.R7$(2),t.R50("ngModel",o.settings.dark_mode),t.R7$(4),t.R50("ngModel",o.settings.notifications_enabled))},dependencies:[x._f,g.Zp,U.Sc,m.qT,m.BC,m.cb,m.vS,m.cV,E.ms],encapsulation:2})}return s})()}];let Y=(()=>{class s{static \u0275fac=function(n){return new(n||s)};static \u0275mod=t.$C({type:s});static \u0275inj=t.G2t({imports:[F.iI.forChild(L),F.iI]})}return s})();var A=p(6245);let X=(()=>{class s{static \u0275fac=function(n){return new(n||s)};static \u0275mod=t.$C({type:s});static \u0275inj=t.G2t({imports:[u.MD,Y,A.t,E.kr]})}return s})()}}]);